(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8276],{43639:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/history",function(){return n(26920)}])},26920:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return pages_history}});var r=n(35944),a=n(10534),i=n(67294),l=n(52129),o=n(82200),s=n(15861),c=n(77343),d=n(82729),u=n(70917),p=n(2734),y=n(43564);function _templateObject(){let e=(0,d._)(["\n      display: flex;\n      flex-direction: row;\n      border-bottom-right-radius: 0;\n      border-bottom-left-radius: 0;\n      padding: 0;\n      padding-bottom: ",";\n\n      background-color: transparent;\n      "," {\n        background-color: transparent;\n      }\n    "]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,d._)(["\n      margin-right: ",";\n    "]);return _templateObject1=function(){return e},e}function _templateObject2(){let e=(0,d._)(["\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    "]);return _templateObject2=function(){return e},e}function _templateObject3(){let e=(0,d._)(["\n      // width: ",";\n      height: ",";\n\n      padding: ",";\n      border-radius: ","px;\n      border: 1px solid ",";\n    "]);return _templateObject3=function(){return e},e}function _templateObject4(){let e=(0,d._)(["\n      margin-right: ",";\n    "]);return _templateObject4=function(){return e},e}let useStyles=()=>{let e=(0,p.Z)();return{root:(0,u.iv)(_templateObject(),e.spacing(2),e.breakpoints.down("lg")),checkbox:(0,u.iv)(_templateObject1(),e.spacing(2)),myTransactions:(0,u.iv)(_templateObject2()),select:(0,u.iv)(_templateObject3(),e.spacing(32),e.spacing(2),e.spacing(3.5,3,3.5,0),y.E0.medium,e.palette.action.active),typeSelectLabel:(0,u.iv)(_templateObject4(),e.spacing(2))}};var History_Filters=e=>{let{eventType:t,setEventType:n,showOnlyMyTxns:i,setShowOnlyMyTxns:l,walletConnected:d}=e,{t:u}=(0,c.$)(),p=useStyles(),y=[{label:u("history.all"),value:"All"},{label:u("history.mint"),value:"Mint"},{label:u("history.borrow"),value:"Borrow"},{label:u("history.repayBorrow"),value:"RepayBorrow"},{label:u("history.liquidateBorrow"),value:"LiquidateBorrow"}];return(0,r.tZ)(o.Z,{css:p.root,children:(0,r.BX)("div",{style:{flex:1},children:[(0,r.tZ)(s.Z,{css:p.typeSelectLabel,variant:"body2",component:"span",children:u("history.typeColon")}),(0,r.tZ)(a.Ph,{options:y,value:t,onChange:e=>n(e.target.value),ariaLabel:u("history.type"),title:u("history.type"),css:p.select})]})})},m=n(87357),b=n(78404),h=n(3718);function styles_templateObject(){let e=(0,d._)(["\n      color: ",";\n    "]);return styles_templateObject=function(){return e},e}function styles_templateObject1(){let e=(0,d._)(["\n      display: block;\n\n      "," {\n        display: none;\n      }\n    "]);return styles_templateObject1=function(){return e},e}function styles_templateObject2(){let e=(0,d._)(["\n      display: none;\n      "," {\n        display: block;\n      }\n    "]);return styles_templateObject2=function(){return e},e}function styles_templateObject3(){let e=(0,d._)(["\n      "," {\n        background-color: initial;\n      }\n      .table__table-cards__card-content {\n        > div > div {\n          overflow: initial;\n        }\n        grid-template-columns: 33% 33% 33%;\n        grid-template-rows: 1fr;\n        justify-content: space-between;\n      }\n    "]);return styles_templateObject3=function(){return e},e}function styles_templateObject4(){let e=(0,d._)(["\n      align-items: center;\n\n      padding: 0 !important;\n\n      :hover {\n        color: ",";\n      }\n\n      :active {\n        color: ",";\n      }\n    "]);return styles_templateObject4=function(){return e},e}function _templateObject5(){let e=(0,d._)(["\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    "]);return _templateObject5=function(){return e},e}function _templateObject6(){let e=(0,d._)(["\n      flex-direction: row;\n      justify-content: space-between;\n      align-items: center;\n      "," {\n        display: flex;\n      }\n    "]);return _templateObject6=function(){return e},e}function _templateObject7(){let e=(0,d._)(["\n      flex-shrink: 0;\n      margin-top: -2px;\n      margin-right: ",";\n      width: ","px;\n      height: ","px;\n    "]);return _templateObject7=function(){return e},e}let styles_useStyles=()=>{let e=(0,p.Z)();return{whiteText:(0,u.iv)(styles_templateObject(),e.palette.text.primary),table:(0,u.iv)(styles_templateObject1(),e.breakpoints.down("lg")),cards:(0,u.iv)(styles_templateObject2(),e.breakpoints.down("lg")),cardContentGrid:(0,u.iv)(styles_templateObject3(),e.breakpoints.down("lg")),txnHashText:(0,u.iv)(styles_templateObject4(),e.palette.button.medium,e.palette.button.dark),typeCol:(0,u.iv)(_templateObject5()),cardTitle:(0,u.iv)(_templateObject6(),e.breakpoints.down("lg")),icon:(0,u.iv)(_templateObject7(),e.spacing(2),e.shape.iconSize.medium,e.shape.iconSize.medium)}};var g=n(93734),_=n(95201);let HistoryTableUi=e=>{let{transactions:t,isFetching:n}=e,{t:l}=(0,c.$)(),o=styles_useStyles(),{address:d}=(0,i.useContext)(g.V),u=(0,i.useMemo)(()=>[{key:"type",label:l("history.columns.type"),orderable:!0,align:"left"},{key:"txnHash",label:l("history.columns.txnHash"),orderable:!0,align:"left"},{key:"from",label:l("history.columns.from"),orderable:!0,align:"left"},{key:"amount",label:l("history.columns.amount"),orderable:!0,align:"right"},{key:"created",label:l("history.columns.created"),orderable:!0,align:"right"}],[]),p=(0,i.useMemo)(()=>{let e=[u[0],{key:"from",label:"From",orderable:!1,align:"left"},{key:"amount",label:"Amount",orderable:!1,align:"left"},{key:"txnHash",label:"Txn Hash",orderable:!1,align:"left"}];return e},[u]),y={All:l("history.all"),Mint:l("history.mint"),Transfer:l("history.transfer"),Borrow:l("history.borrow"),RepayBorrow:l("history.repayBorrow"),Redeem:l("history.redeem"),LiquidateBorrow:l("history.liquidateBorrow")},f=(0,i.useMemo)(()=>t.map(e=>{let t=(0,b.H1)(e.fTokenAddress),n=t&&(0,b.tl)(t.id)||h.eT.dai;return[{key:"type",render:()=>(0,r.BX)(r.HY,{children:[(0,r.tZ)(m.Z,{sx:{display:{xs:"block",md:"none",float:"right"}},children:(0,r.tZ)(s.Z,{variant:"body2",sx:{color:"rgba(0,0,0,.36)"},children:l("history.createdAt",{date:e.createdAt})})}),(0,r.BX)("div",{css:[o.whiteText,o.table,o.typeCol],children:[(0,r.tZ)(a.T1,{token:n,css:o.icon}),(0,r.tZ)(s.Z,{variant:"body1",color:"textPrimary",children:y[e.event]})]}),(0,r.BX)("div",{css:[o.cards,o.cardTitle],children:[(0,r.BX)("div",{css:o.typeCol,children:[(0,r.tZ)(a.T1,{token:n,css:o.icon}),(0,r.tZ)(s.Z,{variant:"body1",color:"textPrimary",children:e.event})]}),(0,r.tZ)(s.Z,{variant:"body1",children:e.id})]})]}),value:e.event,align:"left"},{key:"txnHash",render:()=>(0,r.tZ)(s.Z,{component:"a",href:(0,b.yU)(e.transactionHash,"tx"),target:"_blank",rel:"noreferrer",variant:"body1",css:o.txnHashText,children:(0,r.tZ)(a.Oi,{address:e.transactionHash})}),value:e.transactionHash,align:"left"},{key:"from",render:()=>(0,r.tZ)(s.Z,{component:"a",href:(0,b.yU)(e.from,"address"),target:"_blank",rel:"noreferrer",variant:"body1",css:o.txnHashText,children:(0,r.tZ)(a.Oi,{address:e.from})}),value:e.from,align:"left"},{key:"amount",render:()=>(0,r.tZ)(s.Z,{variant:"body1",css:o.whiteText,children:(0,_.jI)({valueWei:e.amountWei,token:n,returnInReadableFormat:!0,minimizeDecimals:!0,addSymbol:!0,shortenLargeValue:!0})}),value:e.amountWei.toFixed(),align:"right"},{key:"created",render:()=>(0,r.tZ)(s.Z,{variant:"body1",css:o.whiteText,children:l("history.createdAt",{date:e.createdAt})}),value:e.createdAt.getTime(),align:"right"}]}),[JSON.stringify(t)]);return(0,r.tZ)(a.iA,{emptyTableMessage:d?"Your historical transactions will appear here":"Connect your wallet to view your historical transactions",columns:u,cardColumns:p,data:f,initialOrder:{orderBy:"created",orderDirection:"desc"},rowKeyIndex:0,tableCss:o.table,cardsCss:o.cards,css:o.cardContentGrid,isFetching:n||!d})};var History_HistoryTable=e=>{let{transactions:t,isFetching:n}=e;return(0,r.tZ)(HistoryTableUi,{transactions:t,isFetching:n})},f=n(88767),v=n(14779),w=n(27895),O=n(44431),x=n.n(O),getTransactions_formatTransaction=e=>{let{amount:t,createdAt:n,updatedAt:r,category:a,event:i,fTokenAddress:l,...o}=e,s=(0,b.H1)(l),c=s&&(0,b.tl)(s.id)||h.eT.dai;return{...o,amountWei:(0,_.SU)({value:new(x())(t),token:c}),createdAt:new Date(n),updatedAt:new Date(r),category:a,event:i,fTokenAddress:l}};let getTransactions=async e=>{let{page:t=0,event:n,address:r,order:a="blockNumber",sort:i="desc"}=e,l=await (0,w.m)({endpoint:"/transactions",method:"GET",params:{page:t,event:n,address:r,order:a,sort:i,version:"v2"}}),o=l.data;if("result"in l&&"error"===l.result)throw new v.Jv({type:"unexpected",code:"somethingWentWrong",data:{message:l.message}});if(!o)throw new v.Jv({type:"unexpected",code:"somethingWentWrongRetrievingTransactions"});let{limit:s,page:c,total:d}=o,u=o.result.map(e=>getTransactions_formatTransaction(e));return{limit:s,page:c,total:d,transactions:u}};var getTransactions_useGetTransactions=(e,t)=>(0,f.useQuery)([h.RG.GET_TRANSACTIONS,e],()=>getTransactions(e),{keepPreviousData:!0,placeholderData:{limit:0,page:0,total:0,transactions:[]},refetchInterval:h.Pg,...t}),pages_history=()=>{let{address:e}=(0,i.useContext)(g.V),[t,n]=(0,i.useState)(0),[o,s]=(0,i.useState)("All"),{data:{transactions:c,total:d,limit:u}={transactions:[]},isFetching:p}=getTransactions_useGetTransactions({page:t,address:e,event:"All"!==o?o:void 0},{enabled:void 0!==e});return(0,r.BX)(l.Z,{title:"Connect your wallet to view your transactions",children:[(0,r.tZ)(History_Filters,{eventType:o,setEventType:s,showOnlyMyTxns:!0,setShowOnlyMyTxns:()=>{},walletConnected:!!e}),(0,r.tZ)(History_HistoryTable,{transactions:c,isFetching:p}),d?(0,r.tZ)(a.tl,{itemsCount:d,onChange:e=>{n(e),window.scrollTo(0,0)},itemsPerPageCount:u||20}):null]})}}},function(e){e.O(0,[5072,9774,2888,179],function(){return e(e.s=43639)}),_N_E=e.O()}]);
//# sourceMappingURL=history-a202eb372c658836.js.map